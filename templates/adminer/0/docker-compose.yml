version: '2'
services:
  data:
    image: busybox
    labels:
      io.rancher.container.start_once: true
      io.rancher.container.hostname_override: container_name
      io.rancher.container.pull_image: always
    volumes:
      - /usr/local/openvpn_as/etc
  server:
    privileged: true
    image: registry.monach.us/docker/openvpn-as
    ports:
      - ${vpn_port}:1194/udp
    {{- if eq .Values.expose_admin_port "true" }}
      - ${admin_port}:943/tcp
    {{- end }}
    labels:
      io.rancher.container.pull_image: always
      io.rancher.container.hostname_override: container_name
      io.rancher.sidekicks: data
    volumes_from:
      - data
